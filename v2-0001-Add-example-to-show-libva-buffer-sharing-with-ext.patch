From 11ae7f2ffcaf63658bd9eb8e5def76962bfeb8eb Mon Sep 17 00:00:00 2001
From: Chuanbo Weng <chuanbo.weng@intel.com>
Date: Mon, 22 Dec 2014 17:58:23 +0800
Subject: [PATCH v2 1/2] Add example to show libva buffer sharing with
 extension clCreateImageFromLibvaIntel.

This example read a source nv12 file to a VASurface, and create a target
VASurface. Then create corresponding cl image objects from them. After
using ocl to change this VASurface to a gray image, target VASurface is
saved as a file.
Code of loading nv12 file to VASurface and display related are referenced
from libva/test/encode/avcenc.c and libva/test/common.

v2:
Delete 1920x1080.nv12 and 640x480.nv12 because of large size, add
256_128.nv12 as default test image.

Signed-off-by: Chuanbo Weng <chuanbo.weng@intel.com>
Signed-off-by: Zhao Yakui <yakui.zhao@intel.com>
---
 CMakeLists.txt                                     |  27 ++
 examples/CMakeLists.txt                            |  26 ++
 examples/libva_buffer_sharing/256_128.nv12         |   1 +
 .../libva_buffer_sharing/libva_buffer_sharing.cpp  | 443 +++++++++++++++++++++
 examples/libva_buffer_sharing/sysdeps.h            |  79 ++++
 examples/libva_buffer_sharing/va_display.c         | 166 ++++++++
 examples/libva_buffer_sharing/va_display.h         |  64 +++
 examples/libva_buffer_sharing/va_display_x11.c     | 139 +++++++
 kernels/runtime_gray_effect.cl                     |  28 ++
 9 files changed, 973 insertions(+)
 create mode 100644 examples/CMakeLists.txt
 create mode 100644 examples/libva_buffer_sharing/256_128.nv12
 create mode 100644 examples/libva_buffer_sharing/libva_buffer_sharing.cpp
 create mode 100644 examples/libva_buffer_sharing/sysdeps.h
 create mode 100644 examples/libva_buffer_sharing/va_display.c
 create mode 100644 examples/libva_buffer_sharing/va_display.h
 create mode 100755 examples/libva_buffer_sharing/va_display_x11.c
 create mode 100644 kernels/runtime_gray_effect.cl

diff --git a/CMakeLists.txt b/CMakeLists.txt
index a967540..4edf543 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -198,11 +198,38 @@ ENDIF(OCLIcd_FOUND)
 
 Find_Package(PythonInterp)
 
+OPTION(BUILD_EXAMPLES "Build examples" OFF)
+IF(BUILD_EXAMPLES)
+IF(NOT X11_FOUND)
+  MESSAGE(FATAL_ERROR "XLib is necessary for examples - not found")
+ENDIF(NOT X11_FOUND)
+# libva
+pkg_check_modules(LIBVA REQUIRED libva>=0.36.0)
+IF(LIBVA_FOUND)
+  MESSAGE(STATUS "Looking for LIBVA - found at ${LIBVA_PREFIX} ${LIBVA_VERSION}")
+  INCLUDE_DIRECTORIES(${LIBVA_INCLUDE_DIRS})
+ELSE(LIBVA_FOUND)
+  MESSAGE(STATUS "Looking for LIBVA (>= 0.36.0) - not found")
+ENDIF(LIBVA_FOUND)
+
+# libva-x11
+pkg_check_modules(LIBVA-X11 REQUIRED libva-x11>=0.36.0)
+IF(LIBVA-X11_FOUND)
+  MESSAGE(STATUS "Looking for LIBVA-X11 - found at ${LIBVA-X11_PREFIX} ${LIBVA-X11_VERSION}")
+  INCLUDE_DIRECTORIES(${LIBVA-X11_INCLUDE_DIRS})
+ELSE(LIBVA-X11_FOUND)
+  MESSAGE(STATUS "Looking for LIBVA-X11 (>= 0.36.0) - not found")
+ENDIF(LIBVA-X11_FOUND)
+ENDIF(BUILD_EXAMPLES)
+
 ADD_SUBDIRECTORY(include)
 ADD_SUBDIRECTORY(backend)
 ADD_SUBDIRECTORY(src)
 ADD_SUBDIRECTORY(utests)
 ADD_SUBDIRECTORY(benchmark)
+IF(BUILD_EXAMPLES)
+ADD_SUBDIRECTORY(examples)
+ENDIF(BUILD_EXAMPLES)
 
 SET(CPACK_PACKAGE_VERSION_MAJOR "${LIBCL_DRIVER_VERSION_MAJOR}")
 SET(CPACK_PACKAGE_VERSION_MINOR "${LIBCL_DRIVER_VERSION_MINOR}")
diff --git a/examples/CMakeLists.txt b/examples/CMakeLists.txt
new file mode 100644
index 0000000..3fec8f3
--- /dev/null
+++ b/examples/CMakeLists.txt
@@ -0,0 +1,26 @@
+INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}
+                    ${CMAKE_CURRENT_SOURCE_DIR}/../utests
+                    ${CMAKE_CURRENT_SOURCE_DIR}/../include
+					${X11_INCLUDE_DIR})
+
+link_directories (${LIBVA_LIBDIR}
+				  ${LIBVA-X11_LIBDIR})
+
+set (examples_sources
+  ../utests/utest_error.c
+  ../utests/utest_assert.cpp
+  ../utests/utest_file_map.cpp
+  ../utests/utest_helper.cpp
+  ./libva_buffer_sharing/va_display.c
+  ./libva_buffer_sharing/va_display_x11.c)
+
+
+ADD_DEFINITIONS(-DHAVE_VA_X11)
+ADD_DEFINITIONS(-DINPUT_NV12_DEFAULT="${CMAKE_CURRENT_SOURCE_DIR}/libva_buffer_sharing/256_128.nv12")
+
+ADD_LIBRARY(va_ocl_basic SHARED ${examples_sources})
+
+TARGET_LINK_LIBRARIES(va_ocl_basic cl m va va-x11 ${X11_X11_LIB})
+
+ADD_EXECUTABLE(example-libva_buffer_sharing ./libva_buffer_sharing/libva_buffer_sharing.cpp)
+TARGET_LINK_LIBRARIES(example-libva_buffer_sharing va_ocl_basic)
diff --git a/examples/libva_buffer_sharing/256_128.nv12 b/examples/libva_buffer_sharing/256_128.nv12
new file mode 100644
index 0000000..230f4cf
--- /dev/null
+++ b/examples/libva_buffer_sharing/256_128.nv12
@@ -0,0 +1 @@
+FDFGGGGIIIJHKLKLNLLOMOOOPRA)BNQPRRRSRRUTVXVTUVXWWYVXWXWYXXZYZYYYZZ[[[\[ZZ\[Z\\^]]]]]^]^^^^^____`_`_`_```a``acaaacbcbdcabdbccbdcdcdcadcdbccdbccdbdddccddcdcdabcbcbcbccbbcaabdcbbLhiututtuuusqomknopsqrstuuututsrqoponnmlkkkjjvWY[ZZZZZ[YZYXXYWWWWX[YSg_[CGGEHGHHIJHILJLLLNNMMOPOPO:(EPPRQRSSSTUTTTVWVVVVXWXVYXXXYXYYZYZZZZY[[Z[Z[[]\[[[]\\^]]^_]__^^^____a``aabaabababbaabaabcacbbabbcccddddcbcddbdcddccdddcdccdcdbdbccbcdcccbbcbcbbdb`Lhiuuuurqopqrsqtttuuuutvsrrqpoonmmlijiihfddb`wXX[Z[ZYZYZYXXXXXWWWWWYYQ_FFDFHGFGIJIIHHLJLLLLOOOOPP3+HOQPRRQSTSTUUUVTVUWXXWWYYYYYYXXYYYZZ[Z[[[[Z[[Z[\[^][]^]^]_^^^]^]__^```_aa``aaababccccbdccdcccdccddddddddecdcdddccdcddddcddedccdcdcddccdeccbbabbcddaKggqsttuvwvwxxwxvvssrqponommlkkjjhgfc`]ZUROLKxwYX[[[ZZZYYYXYXXXXXWVWVXVeZECFGFGFHIHIIIJJKMLMNMOONOP,-KOQOQRSRUSUUUVWVVWXUWXVXYYYYXYYXXZYZZ[ZZZ[[\[[[[\\Z\]]]\^^_]_^^^___a_`a`a``baab`cbbbbcbbcdccccacddcbccdddddcddddddddddcddddedbdcdbcddcccbbbbabccccaIghwyy{yyzyxvussrqpopnnmmmiihfda^YURNLJJMOQTUwyZU[\\ZZZYZYXYXXWWVVUVVVUQOCCEFEGEGHHIJIIJJKLLMOOOPPL%/KNPQQRRSSTTRUUVVXVVVWWYWYYYZYYZYZ[ZZ[Z[ZZ[Z[[\Z\\^]]\]^^]^]__^_______a`_a`bb_cabacbccbcccbcbcdcdddccbddcddddddddeddddddddddcddcdcccdcdbcababcbbbbdbKfhy|zyxvutrsqppnommljihec_[WRNKKNORUUVUTTTVVvÑ}~z\UZ[Z\ZZZZZYXXXWWWUVVTTUSOCDDEGFFFGIHJHIJJKLLLMNONOL"0LPQQRSSSSUUTWTUVWVWWVWYYWYVXYYYYYZYYZZ[[Z\[\[\\\\\]\\^]^]^^]______``___`a`aa`cbcccbcbbbbdccdcddddbedddddddddddddddedefeeddedddcdccdddddddcdbbbbbcccMefvwtttrqpppnmljifc`[WSPLNNQTVWVVTUVWVWYZZZ[u~}{^SZ[[Z[ZZZYXYWXWWVWVVVTTTSCBDFDEEDFEHHIJIJLKLNLNNMQL 4NOQPRRSTSSUUUWUVVUVXWWXXYXYYYYZXZZZZY[[[Z[[[[\[\[\]]__]^^^^]^^]___``b`_babb_`bcbcbccbdbcdddcccdddddedeedddddeedeeeeeeeedeeddddcddddcdddfdccdccbcbcbJefrsrrqooljfe`\XSPNNPTWYZXUWVWXYYZ[[\\\\^^^_qĘ~}}|`S[[Z[ZZZZZZYXXWXVVWUUTUTTBBDDCFFHGFIHHHIKJKJKMMNNNF!5LOOQSRSSTTTTWRUWUVVWWWYXXYZYYZYZYYZ[ZZ[[[[[\\\[\\]^^^^]`____^__`_``_```b``abbcdbcbccbccddddddddcdedddeddeefeefffeegeddgdedddefdfcddddedddcddcbcccdcLdfoonlhc[SSRONQVY[ZYYXXYYZZ[]\]^^^^^^_____``n~}}{bO\ZZ[ZZZZZYYYXWXWSVUUTTTSEBBCDFEIFGFGIGIJJKJJHKMMMF$:NNPPRSRSSTUTTVUVWWWWVXWYYXYYYZYX[Z[Z[ZZ[[[[^[]\\]\\]_^^^_^\___]__a_aa`ababbbbabcbbccbbddcdcdcddddeddddeddfeeefedeffedfeefeeededdddddddddccdddcddcdcOcdb^YUQNPSZ]][Z\[Y\]]_^__`____``a`_`b_``baaci}}}}dT[[Z\[ZZZYZYYXXXWWVTWfVTT56<L>&17@CEGHHGIIJJKKLNNMA&>NONQRSRSTTTTUUUVWTWXXVXYXXZYZZZYZZ[[ZYZ[[[Z]\[]\\]]]^_`__^___^_``_```aaaabbbaccbccbddcddcdddeddddededeeeeeefeeeefdgefgedeffeedeeeedededdddcdcccccddOcdVV[aa]VQ\^^^__aabb`aabaaabbabbbbbcacaccbcdk~}}|gTZ\\[[[Z[ZYYXYXXVWVQcfbUT *+%,: "#"#&)-149@CHKKLNL=&?MMPOOQRRSSSSTTUVVWVWXWYYYZYYZZZYZYZZZ[[Z[\Z\[[]]^]^]]]]^^`]____^`````aabbbbcbbbcccccddddceddedddddddeefefeeeddegeefefffefffeeedfeddeeddeedddcdddcddQcda`^__`\Tbddedfcedddcddddcddcdcddddddddddeej}{~|iU[[\\\[Z[ZZYXYYYXWWM\EWUU"%.$"( !"!"#""#$$&$%&+/373',BLOPOPQPRRRTTTUUUVWVXWWYXYXXYYYZZ[\Z[\Z[\[\\[[\]]]^\^^^^`]_______````aaa`cbccadccbcccddddddedddddcdfeegeefeeefegfgfffffefffeeeffefffdedeeddddddecccdR`eefhhhhcYeghffffggfeeeffgedededeedeefefeffgl~{|}zjV[\]]\][[ZZYZYYXXXVKQCJ_T" !""$"" ""#"#$$%$$$%$$%%&'''*.26;AHPRRRSSRTVWVUWVY[XZYYZXZZZZZ[[[[Z[[\]][\]]]^^]^^^___^__`_a_a``ab`aabbbcbccdcddbedddgdedeeddedeeefffgffgdffegggegfggfghffffeeededddeedddddcdccQ`dkklllki\ijjjiiiiiiihghihhghggggghggghhhiigl~{|}{kXZ]^\\\\[ZYZYYXYXWWKYHEbV"!""%$""""""##$$%$$$$$$%%$&&%%&&'(()+),28<AJPQWVVXXWXXYYZYXZZZ[\[[\Z]]Z\\]\]^]^]_`]__^^__`_``a^`baabbbcddcccccbcbddeeedddededeffeeefgfeffgggfghghgggggghfgfgffffedeceeefededcdddSadmnoonnm_imllkklklkijjjjijihiiiihihhiiiijjjm~|||{lYZ\\^\\\\[Z[ZYXYXWWL\]@VV+*-))(&&%%$$%$$#$$$$%&%%%%&&%&&&&&&'(''(()*+,+.4EVXXWYYYZXZY[ZZ[[[Z]\[[[[\\]]]]_^\^_^___`````__`aa`bbcccccbccccccddddeefddfeeffeeebfffgggffgghhhggggggffgghigfffieeefefefeeeccddV^dmrqqqpqclnonnnlmmmllkllkkkljjjjjjklkkkllllm|z{zl[Z]]]]]\\[[[ZZYYYVXOTuKkY+++++*+++*++-++*+)''&%&&%&&&&&&'''&(()'))())+)++5VYXXY[YZYZ[ZZ[ZZ\[\\\\[\[]^\\^^^__^^____``a``a`a``aaccbbbdbddccdddddfeeeeeeefefefefhgfegffgghhhggghfgihehhggfggfffffeefeeeeeeedV^dotstsssiopqqppponponmmmmmmklmllllmlmmmmmmop|zzzm[Z]^]^\]\\[\ZYZYYXVQMsnx\+,++++,,,,,-,,...-.....-.--+*)(('((((())))(*)**+3VWXYZYYZZYZZZZZY[Z[Z[[[\]\^^_]^_^^_____``__a_a``aabaabcddcdccddddedfeeeddefffefeeggfggdghggghghhhhhghhiighggfgehfhggdffeeeeeeddX`dqwxvuvulttsrsrqqqrqpoonnnnonlnnnmononnmoopq{yyzn]Y]^\^\]]]\[[ZZYYXXSHrz|[+*+++*+,+,----..//./.0//0//11/0010/./-,+++))*+++/PWYXXYZZZZZ[[[Z[\Z\]Y\\]]^^^^^^_^__^___^_`aba```abacbcccdbbcdddddceededdedeeffffffgefffhhhhhgghhhhhghihhhhhhgghghgggfgffedfeeefX^eqyzyxxxjswvuussrstrqqqqrrppoooonopppprrwy}|zy{o\W^]]]]\^Z\\[]ZZXYXUI^}|Y+++,,,,,-,,-.-././/1/00/0101111212223433332211/-/KYYXXXZZYY\ZZ[Z\\\]Z\[]]]]]]^^]__^__^`_`_a`aa``baabcbcbccccbddeedddeegeefffefffheeegfghhgfhhhhihhihhhhhhhiehhgggghhggffffeddeee[_dr}||zzzpvwxxvuvtuuutssrsrrrprqquy}}yyzoZW^_]]^]^]\^[[[[ZXXXNPz|Z+++,,-+-,....-../00///0011112313343344445454653,.GWXYXXZZ[[\[]^^]]^\^^_^^^___^^^`__``__^_aa`a`abbaabcabcddcddddedddeecdffedffffffhffghhihhhhhihiiiiiiihigjgiiggihhhhfggfffeedeeeZZdr~}}||oxyzyyvxwvvwvvtttssssrss}zxyp[W^]^^]]^]]\\[Z[ZYXXSRwxW++++,,,,,,...././000010011221322445446555566665..AYX[DtªƦdJ\b`_____````ba``cb`b`cbcbccdccddcdedfeeeeeggefgeeegfgigghghgihihiiijiiiiiihhhhhiighihgggfgfhefff[Yds}ku{|{{zyxxxxxvvtvtvutttv~xxyq[U]_]_^]]]^\\\[\[YYYWSjjS,,,+,,-..-.-.-.0/00/0102121224333435555555566760-~~~~K_``a`aa`aaababcccccbcdeeeddddefeefefffefgggghggghhihifiiijijiiiiiihiiiighihihhhggihggggedf\Xdrju}~}~|zyzzyzxxwuxvwwvuv~ywyp\T^]^^^]^]]\\\[[[ZZYYVSKS+++++,,.--..//000/0011112323333444345567866779}{ywwwvvvwy{|{Xa``_`aaaaabbbbccdccddddgfceefffffefgghgghigghiiiihiiiihiiijiijjjiijjhhijihhhhihihggfgff]Wcrou~~~||{zz{yxvrqljedhlEy}yvwp]T_]^_^^]]]]]\\[ZZZYYXROU,+,,,---,...//0//0101222222334344445665778878|~{yxvutwuuuxxyz{|}b`abaaaabbcdbcccccdddddeeedefgffgegegfgghgihhhihhiiijjjijjjiijijiiihiijhiihihhhgggffff]Vbrpv}zxrmgefhjknoqsuwwxj_@yyvvq^R__^^]^^]]]\\[[[ZZYZXXWV+,-,,---.../0///00021212222344545655579787987}v}|xwvvxuuvxxxx{|r`aaaababbcccbcccddddeedeeefeefffgfehhgiihhhgiiiiihijiijikkjkikjjijijkijijiihighiggggf_Vcqzkdgddggikloqruuvxxzyz{x|iQM}yuuq_S^___^^^^^]]][\\[ZYYYYXX+,,,-,-.-....1//11112233424354545777676777898gy}zxxutwuuwuyxz|}a``aa`abbbaccbcdddddeedfeeefdfhgghgighhhhhhiikhhiijijkjiijkikkkkjjjlijjihiiiiiiihghff_Tbdhffghhijkmnpopqstuvwxyyyz{||||k4eztuq_R^____^]]]]\\[\\[ZYYYYXW+,,-,--......1001111333333335355567798767798:|}w|zxvvuwuuuwyyz{}Nkva_`aa`aabbdbdcdccddddeefegfefgggffggghgghhihjjijjjjkjjjjijkjkkkkkkjjjkjjiijjijigighgh_Sbceikkllmmononppprstvyyz{{|}~}}}g[;qusp`S_`_`_]_^]^]][\[ZXYYYXWW,,,-.../.../0/002113233443545565777897778798:}y{yyvuuvuuuvxyz|}nmynkf]ma`abaaabb`bbcbcddddedddffgffdfgggghggiighhhihhihjkjjkkkkkkkkkkjiljkjkkjjjkiiiiijhfhgeaPbbbfhjlmlmmnooppoqsuvyy{}}~cNGptqaT^``a__^^^\\\]\\[ZZYXYXW,,,--..//..//11111123444544456657678887788:8<zx|zxvuuuuvwvyyz|}r~n{+.6ma`aabababcacdcddbddeeeeffefggfheggghhhhiihhiiijhjkjjjjjkkkkkkklklkjkkhjkjjjjjijiihhhi`Rbaacdfhklmnnooqprstvxy{}ib7VrqbT_```___^^^]]][Z[ZZZYXWX,,--.-../.0000112333345445556666678898887898;wzzywvvvuuuxwyzz|~>Wq]Z,.30nk`aaa`aabacbbdcddededddefdefdegggffhighhhiiiiijhiijjjjjlljlkkjlllklllkkkkkkjjijiiihiihbQa`aabdffhjmooopqqstwy{}{gw`X=aqcV`aa```__^^^]\][[ZZYXXXX,,-.-..///1/111121334364455656678889:9:998::8~yzzxwvtwuvuvxyz{}Q|iva<-.4:faa`aa`baaccbbddddddeeeeedfefeggfgghiiihhghihijikjjjkkjjjlklkklllllljlllkljkjjjjijihhh`ObaadbddefhjlmnoqqstwzsixpaHIkfZ_caaa`_`_^_]]Z[\ZZYXYWW--...////0/0112222344555565677788989:989899;<vsz{ywxuwuuvwxyyz}~;Sj]n2,13@{fa`aabbbacabbccdcedfdddeffgfehfffghigigihijjhjjkjkjjcl^himkllklklllklkklllkkkiljijiihhcOa`aaccdeffhilmpvyy~~zz~lQbrgxvf\5Se[`bbabaa`_^^^^\\[ZZZYXXX-../..0000011222333545566566678999::::999:;:=wrfyzyxvvvvvvwxxz{}tv{qv}:G.SS>d`aa_a`acccabccccegrsuritnigigbb_`^Z]\XYYYWXUSZYUVWUURMPownllllllmklklmlmkkljjiiiiicLaa`bddfeffghh~śE_nqcXxws_S;TZ`baabaaa``^^^]\\[ZZYXXW-2..00//01/11223334366666687779::::;;989::::@sxx|~gxzxvuvuvuvxxzx{|L0=QPso0/4>e`aa`aababacd|rOIF=OLMOONNOOQPPQQQQPQQTRQRPSRQRQPOQOQONPMQXcmyrmmmnmmlllllljkjjijjiicMaa_bddffgfe_Uqtmnfgi_]WQG3@atdJ{wutj]@>V`ccbbaaaa`__^]]\[[[ZYXX/.../0/001013334454465557878898::;:;;:;::<;;@quvxvoonoqrsstuwwyyz{y~|ymYeErxxH7:y_`````baanL5--PiVNLNOOONORPONUG@HHHKEDGMRRVc\^dam`fT];=ADHMUcymlmklimmlkkjjjkkjjifMbbc`cfggfXI>7>FAAF;313,)).)'5^rcFwvtsp`Y2B_ccccbaaa`__^\]\][[YYXW./.0000/11212243464667677879899::;;;;;;:;<;<<suwxvonjjiijkmortvwy{{z{{{zyvwxywibkt|zJ]Te_`_`ahiJsqlyDSU[eiI:><BXnmlmllmllllljjjijjeNab`]adghge_VHD-(',*()((-CV<,5]qdFywrrql`O5Rcdcbbaa`__^__]^][[[ZXY/..00/0001223334656768787999:::;;;;<;;<<<;;<@rwwxupmjighiiiijlmpswuqijuxyy{|~c_ayEqtc```abYHLkggvG@I{uzIHI||{^afnmmmmlmlmmjjljjjigLab][^bdffbbge`<**@=6310Eim[=;\oeEvsrpof\67adedcbba``__^^]][[[YYY.//0111101134455667789879:99:;;:<<<<=<;;=<==>rwxzxppSfidnoonmoqvxxk>--y}|~ysgba```a[JPhfgtDA@BiklkkQSRRRjhiiiDBACGiiiiiPQQRWqrqyFIH~||^`_}|rmmmmnmmmmlkkjjljieOaaa\\bedbbfhhpY+-QG:654BghM67WhdT̦vronmj]T4Adddcca_a`a__^_]\[ZZXY./101211123334585878889:99::;;;;;==<==<==>>?9{q{aqiYY^jlnstvx{zwE))-w~c``__`ZJQgggqDA@DifgggPQOQPgffggEA?@FhhfhhRQQSXooqxFHI||]``}}nmmmmmlmllllkkjjjiePag|pvq~gfgmncNWhaY[adinlQAFOPLM_̪{tronmkc[F5Vdddcaba```_`]][[[ZXY//2121112334656788899:::;;;;<;=<<=>=>>?>>>??;sk{f.^4-epsuvvxz|{zs[Agaxb`_```XKOgffoHIIFhggffRRQTQhfgghDBADHffgfgQRTUXnoqxXHH|}da`}}xmnnmllmmmllklkkjkfLbg|smlflihgggdccabc^J?<>@CEGAJ|o]XUOiqsqpnlkcZY06bedccbba``__^]][\[ZZ/012331233556677888;::;;<<<===>?>>=?????>?@@9Jsyxtoa4*5lsuuvxyy{|}}wH/*7``a_abYLOL>UN66558lihiZ555559liiCQ44444ShjSWQ3564FzHHQhy{d`_~|ummmnmmlnmllkklkjkfPbafb`[YX\\]_adginnpqtstrjA559@?C?:6@?=31/+3?BcqtqonmkcW[Q3Idedebcaaa`_^^^\[[ZY100232334467677899::;;<<====>????@@@A@@@A@AA:*wwvtad4(:Mclqtvxz{}~~zH,-r}w}aa`c`aF<I?_zE<^dZVWXO5RjH9[UUVYF6bj5>[VSU[44nX6=cXZb:8K[90;:j_i:3|pnnlmollllllljjjifPabfhieagifeb_\YWRQKIFDB??9217;><:529>M311+/7;\jtpnnmkdWY\;5`cdccbaa```_^\\\[ZZ/01244344466779::;:;;>>==?>??@@@A?AABAACABBB<'w|}k+]jllgV+Kmswzz|~|ulrL}wmiv``_`a`Z[Fy6fjkgk\lkM=ASWX5~YW\I9DWUZ3PZV\FANYUM;3YWaUU_XfL6`a`f8a:pl]mnmnmnmmllllkkjiifOa^IFC?><9754321001012112874661001024=U756/-13?XqpmmlkdV^\W2>eddcbac`___^^\[[[Z213344456678989:;;<==><>>@?@AAAABABCBCBBCCDC:"zlWwyyxutspc(bty{}}T+*Uzmhek_`ba`aBF^iC@A>j<88847T5569766Y~637873:b\648743b@==Ycm_lhkmnmmllmmlmlllkkjieM`\;43554442101121033434472042-,-////8G8651-211KqpmmkjdX_d]H3Reddcbbb`__^[]\\Z[223445576789::;;=<==>?@@?AAABCBCCCDEDDCEDDED;#~R}}|zywxxvsm9]tz}s1-~yLx}rhedj__`aaa?:4>BB=ol;:8775W6567765rS/5686745988852:?=;|39=`mmlnnnmmllllllkjjfOa_PLJGFCEF8.02233344544;C7122/-/1.-.6M9662-430LpnllkjcW_i_Y39bedccbaa`_^]]\[[Z3444566778::;;<===?>?@AAABBCDDDDEDEFEGGFFFFE<(x2|~|zxwwwwun0gw}(.axmfdcja`aa`a=<YTiquxedxiab``__^_^^b`Cb``__`b_fdfiu~vT959V=;almmmnlnmlmllllkkigQ`qv614554555768JiAC?83461.9[Y9864/440KomlkkjcX_if]P2Efcdcbba__^\\]\[Z44466677::;;<==>??@@BBABCCDEFFGGHFGGGHHGGHHH=%zj}yxwxwxxul(pz}vUTzrjecbk```_aasGVLMQ]PRRZZ]]^a^^]\]\]^6]]^]^]^fbe_^INdGHaNNMOSglllmmmmlkllmnnkmfPazF4677678689;Af_f\TRKA9Q|]<:950562LomlkkicY^iha[<4Yeedbb`__^^^]\[Y45667889:;==>>>?AABBCEDDEFGGHIHHIIHHJJIIJIJJ=%w~}}{ywuquwxt]Vx}..||wmheebn_`_`aasHIZSNXQ[UU]_]b]e^af^\\^6]]]]_aaa_^_`MMO]IbLJMKAtlllllmllmlsuPbmE698989::::;=XtrPToR=;;92753MomkjijcZ^ijg[U0;bddcbaabd]^^\\[556789::<=<?>?AAABCEEFFHHHHJJJJKKKJKMLKKKLLK?&-mt}}{yuU<_vywr&s}zfgtrkgedbn``_`a`nJLOLLZPQV\Wq\_[^_^]^]]]7^]]^^]``d^aGKMNNcLPQNVslllklmmosʼٽRbxG8;:;;;<<===?GprPOF=>?;3:55MokkjjjcY`jiid\I2Nddcb``de^^[\[Z47779::<<>>@A@BBDEFHHIHJJIJLLKMMNMMMNNMNMNNM@28*j}|{zu38rxxyt6l}_/lmihdc`h_aa_``mJLNKN[TSW]Y_c]c`c^_^]_7^^]]_d_i_`_LXJMcLKLXmklknls̻WbpD:>=AKQLMDCA@Dy|d\UPNW[RHA>A@<4<39NnljjiicZ_kiii_X/8bddcablf^]][\[78799;<=>??ABCCCFFHIIJKKLLNNNOOOPPPQORPPRPPP@Gai||{ywsrwyyyv_bzwgnhWcb`[e`_`_`amFGHOM\QZQS|l`cb^_a^]]^5\\^^bb^_`fyWKGR`LRMLgkpvmkǠXqG:?OP_efj^cYTR[_QB@@@ACFGGHEFJNe`;8KpljiiibZ`kkkjh]O2Abccfwk]]\]\Z889:;<=?@AACCDFFHHJJLMMNNOPPQRRRSSSSTTSRSSSR@kq~|{wwwxxxyywhIpvwx{}yslc\_YXR\_`````l^MLQR\\WZ\^ab]UZa]]_6___dcbcde`MQRVaNYO[rſlhiiizpB;@FmQbTP\`OgjOC>>>==?ABBACBBH_ANnkjiihd]`llkkjcZ95Xchuzf]\\[[9:;;==?@BBEEFGHIKKMNOQQQSSTTUUUUVWXWWWWVWUVTBrxzneiotxxzzzxl>koqrruvwxyzyxvsnhbXT<:DLS_`__``hkEMIM\NOeV~t_c_Qcf[__8^]_^_`e`_|DLMK`NKQ^Ľu|eoфW`TQdZLb]NBXym?>>=;=?@CWdJmllihhb]alnllkk^S/=j|r_\[[\:;<<>?@ABDEHHIKLMNPPSSTTVWWXXYYYZZZYZ[YYYXYWAtznrxwuoVtxyyzxk@loqqstuuvxywtsold`Y>:@BDO______knONPL[PVNOXGCNMfa]]7_^__d`^_fZ]^`JXLZ½ĺgs}ʎG28CGDRyaIBVx@?>?>>>>@RtfYmkjiiid`annnmnlg\B7[~~}m\VY_;=>>?AACEFHIKLNOQRSTUWXYYZ\\\\]]]]]]^^]]]]\\Vuurz{zxtlVuyyzymNloostuvuvxwutrojda^YXTSNW__^`_`if?WNOZQWPJMDKIHbW`8_____e]`s\~PcPNK˭ZX[^dfimovnzI:?LWJssQb|y{wrnd^jxf`mkhhhgdacnoponmlaV.=}}}^e{=>>@ADDEFIJLNOQQTTXYYZ\]^^_``_aaaaaacbb`a`_^hvg;rwwsk4:vyzzvW]npqruwvwxyxvtroiea`][YVRW^___^ZjI;GbKXOMP]MCDtFcH_^7_^_``__VdfpkSNPʼȫSRRLKLLKKIKKYJTDYab~zWY~|{z{vwtmX\liihhgdedoqqrpoooZJ6Q|ywx>?ABCDFHIKNOPSTUYY[\^``abddfeeffffffefefcccbewF+,IU<,+fv{zzr$forqrutvxxyyxurpjfcb`_^\WK__VKLHl=:F?MZNSeEKQHTEKZ9`]^_gaqcgmdOV^թTROIIKFC>>GHOJ`jdgjw}o=Zc^cihkehhda^[S>HljfggeegdpqsrrrsqX4<ky=ACCEGHJLNPRUVXY[]_`cceehhijjjkkkkkjkijihgggWx1r)))*9itxyzwi=lrrsuuxyy{{{{zxwsnkjheb^UOMHLE>;l\pOCW\XL`GBjDb5_^_j_Zo|pccaQN{UQLIII@9<CGGGuO]BScjinjhPTBDJKPPKNMOPTPA8Gjihfffdhfpprrrr|^P7I@BDEGIKLOQSVXY\^acdfghkllnoppppppqqpooonmmlkuRyqnpuuxxyxn-nvz|}~{wqnlifb\XQME:533mnqJ@ddtU_`}OgGGpYjkiRSS`d]{mcldawɦͰtgigpRNJHC=:?FGHHJtWfkNgotpwI4X}758:=??@778;=87FiigffedifqppootY;LzͼBEFFIKLOQTVZ\^bcfgjlmpprstuvvwuuwuxuvuutssqqzy~|zxyywwuo1jx}}xrplif`]YPB636=MjnoJ?pZx?UQTfKYjYXXqJIz_SPZ}picfkȘtfynkkpn^QMD>=C@FGHHGLuS[CPcp^y]3Xx333567<?1-,+)47BiihededfepsqpoyeRDtøDFIJLNQTVXZ^`bfhkmrrtwwz{||}~~~~}~}|{zzywt}+}|yxyusnX-oy}}xsolhe`]W\=BVcbbjnq<@GKC;PGhCFGEG[orKeFMTOLZifgqipƱkfflsyxrvSE=?EE@DFFFGDIqM^krjfJip3Vf:KOVSSJ;8/+(*8:Pjihffddicorsqs\C}FHJKNQTWY\_cehknqxxz|~~{%ltwsqoi]9.brx}}|ysokge`]VW=?DGNUjmG<]E?>eNKHGGD[EHMHNYaNNhhkwr~|׫r`cd^SSSPwkI:EMGCCEFGDCBESL\cDemPis7WT09BCHJD:453/*07Jjihedddhbkoqo~wVAxGJLNQSW[^achknrv{}<*+! .C-Zkrx{|}~~wtolhea\VK/0//12lm<<DJVCDBeDEGHFXHFJG\gF|zmk^qanuj_dd^OEBI`~~D:7<A3PNY^bms[tr8WE,09?@CB82/-+'/:Kihgdeccd^hgiq\M\JJNRSWZ\aegmqu{||Gfi*`hY*U0mvz{|}xrmkhda[UL<99998la=EEJWJJEjIL\J[]]9_^WEKFIur\Yn[]nvrrkjac`XSV[PTSZU@`Jgf[eo9U>,,37:;;;2++();CKiigfedb\[a`\Xa~İx79:==@CFIJMPUX\_dgkmoqqqqpqqrrtututroqonmmljvHV*VD[Q8\Qty|||xrmkgd_ZSL@?=;:<hXmDDIRJKRJKH[]^^^:_^]^[GNGpYYp\ZuWW[^_YSQc_^[[hؿ؉n`Tfzd6T1+,.00002/)'('1?Liheded_WW\XQB39Lncuxrnw9@MVQGEFJNQTZ\bfjpuw{{yyxxyyz}}~|ywvuuuutsx'otn$PL,kxz|}xqnjgc^ZUJ6:.-9>gkmCDHQJKwfUQ]\]_^_5^__^^_]LYWq\ZSZ]\``UaZWhiͷvqwmT4Uw@<@?GHKK=5.'&%+3Gihfedc`TQXVMB74@qie}50+%'*1=J[X[`chotz}|}|zx;b7\oD=Gwz|}yrnjfb^YSI:;9448hkmDEIOJJV|Xa^_^___9______hp]vWUwYUTttxwvvuuwžHXZF4XqVK<74.,/9Qjkjfdd_QIo{}~|K4-2gqposqrlt::>?AIKD,$$).6CQdy|vvljedgirujaYOHHGHIOQOGGv||)b3kvuoqxz|wqmhe`]XRH6;77CSfjcBDGSHKO__`_^_a;^^____`[WVtVUS_rnlrprcMB4fec_N@s~M*((,KSVX[\>7e///00002223433.*%&''08?GPYhb\OFA=:;;::;;;;;;>+V}}u<r\hvxxyyxyx|{|vpkgc_\VCG;;?JG@ehGACGQHIKa_^^^^__:`^_____hYUSqUTTEJKHIFҾL7x}~uyzywy}zfcM>[lqy|~~x@''((/+((++%%+..0011114453588;;=>ABAA>;0,'%'')+*+++-257=@D@{)NvugOjdYouvvuUPnj1q|ysmgc_\VM=HnWE@??cfC@BGPHHJ^^_`_`^_8`__`^``aTRSoSQPpqrkp~»̧Kk򔈂etjxxm*(((,,%'*****:05<966577>763;<=B:555A2:72005;5105458221<.4:o(Nun'1cC-7fkml`mkqcirtvuxxxyxxwtrnhc^[WRPERIā5468bf@CBEQHGJdp__`^__]`<`_____``{QPNiPNOLMO\~xssb½ɕK`~Z2345457677:<=BBCIHMQX^fllqry@677A:9?HP?%&+&&)'-77*-0<`]T1310957./1//8A223708:447:<494?+pruqb^c_#bdjkhToxzhRlqtuvwwwwwtrqmfa]YVRNIJKu<7-,+TKZ[KMTZ^nv~heeeffgffHhgghillqrvxYT[iKUsrojgceĺͷPfivxrtx|x=88765124231/.//022122223457?>932425200//.+30/..,--.-././1244579999:;<<<>=<<;:68#+04DH2+uxvsmknl]hkkiIakutgO8qtrvvvvvvurrlf`[XSPMHBIPJ1/..SLXampuy|o|r}~~}~nnYeorpqrqc~~zwefdcb`Z͵~}Pdcabbbdv\E=5,../202234333323343222232211111/007r,)AGXdgijcYSEBBB?;:98:8:9<;:<:=:;<==9<:<<=:=?(sxxusqpnmlllkfd^cIhjnrtsvuuvwvuspjd_ZVROJHEA:7447<]UW>DnqrKit|r]XmpYrnW{oXp~qsRdSjMu]Jylbaba^^_b®KR[cwvnf\N@:2.&'+*+++,-,-+(*+2Lu0011257877655579:;;;;<<==<>?>???@??@@BA@ABBCFdwywvsqppnmllklljG^moqsssvvuwvvusojc]POIEHFB9+**-CHGK4bD@@CR{mqHFIJOJHGLopmw[GHNLJLJIxyprqLJNKJIIK~LMJDB:\\]^_^\[UU\ȿ11////123:;;;;;;;::;;<<<>@=;<;:9577<CJMV]W_UMvxzywsqponmlmllmmklnppqssuvvuutsqoia[OGDDEFE9))(((-///2ejmsw?7>AjPLYv`:eH;~aSYt;DG<Svx}<7;{887:\\\\^_^XVIP`NWw~58;9<<;<=<943321.--*+)&'''''&&&&'&''(')('*(),uyzywtqqoomlmlkmnnmppqsrsrsutvtrpoh_ZPCP1CDG2()(((6/./0145764779:8t~q?::9::::9T}~C:;;<;;;<3KlpS2=<99;8:977668^^[[YY[FGHDKEEElz|{vx{{}|z}~}~!! !!!   !!    ""! """!"#""#####$##$$$$$$$&(s{|ywurppnllkmmlmnooooqqrrtttrrpnle]WGOM9BBG++,+..6//./113546879:8999:99CB999:;;:9;9;;::<;:;;<;?;<:;:98:<:9998786wbZ@=F7;A?IZjmqruxwz{y|||}~     "!""!###$$$&u|}|ywtqpnmlkllllmonopqqqrrrrrpoljc[UHACA@@Evtvtqp`1-./1125676689998888KG9999:::<9:9;:;:;::<:=?=9;::9799:8777878:UKC<8:EYhostrwwwwxyyxyw{|}   !!!!"#$$%'*v}zxuqpnmlklllmnmnopompppqnollkhbZSLH2A@=C/../011345678989799IEGYGPSM<9>AAKPSG@;D9?;A8;::99979;878767668nH@@MGclppqtstqstuvvvvxxz}|~~!"!#"&(*)("&'(/;T`v|xvrqmmmlmlmlnmnnmnnooononkjif_YQLHC@>;A-.../0012446897898??;:BA:;CH9AM<<:7:;>=;>9;::9999:7<;<<;<<;:89d_debfea`\^IHKTkoqnorrrpppopnpqsuuxvxz|&'(*)&'# %,5;Qiw}yxusrrqqppoooopononnoonllig`ZTMJGCA?GzuqeZL/-././0033357777888897989=<9;;8988888898:8888899999;===<<=>>>Bxl\XUQQM`q}rlmoppommbklihilnoqssuvx{~~~}}{yxxwvttsrrqqqopnqonmlkfaZTMIGC>;>USMIGEE@94.-.//0245776887788698798898877767787676766566689:9984-H[MgvlbWRMrmldiihYahcehddhjjmlnpstwofgHAR]jfjiijgggeddedcbccddaa]XPFA;>@DHHHGMNMMKJHB>;40049=B6:9=788776776677677777557665866666676977C?%,06>DIR`v~zk^]g^^_]Uaaabccbdefhhklnimr}lcZTQ}~||{yvsqpnkjihikmnljihbbbbdcdfeegb`PJKIGGEFFFGIJKKKKKONORTPRTSYZYZZZZZ\\]^^_`cfkrxytndLMRVWXZ\^^_``a`db[fjlptx~yja[TOLHC~pcXPHCA@HLOQSTVVTPLXbimnpsw||tg_TOJID?<;wk^ROKFB=:723438=ISX]beimoty|of^NC@A?=:76xha\ZYWURPNPPOSUX[^abijpz|tj]LGA>>:9767yvcMA>:;::87::zpYB98689:98::zrL=53989:8:6*z{tP526899;+ ~|{Z25794#}zv86/|{yb$¿wysUyspW!rmT$ym[+mhA!}gQ-r[?$iM¿¿¿}~~~~~~~~~~~~~~~~~~~~~~~~}}~~~~~~x}}~}~~~~~}~}~~~~~~~~~~~~}~}}{z}~|~~~}~~~}~~~}~~}~~~~~~~~~~~~~~}~~~~}~}||~w~}}~~}~~~~}~~~~~~~~~~~~~~~~~~~~}}~~~z{~}}}~~~~~~~~}~~~~~~~~|~{~}}~~~~}~~~~~~~~~~}~~~}~|~~~~~~~}~~~~~~~~~~~~~~~~~~}z{~~~~~~~}}~}~~~~|~~~~~~~}z~{~~~~~~~~~~~~~~~~~~~~~~z~~~|}~~~~~~}~~~~~~~~~~~~~~~{}{}~|~~~~~~~~~}~}}yy{}|{}y{z|v||{~~~~~~~~~~|~}~~|~|~}~~}~}~~}}~~~~~{~|||{zzzvt~~~|~~~~~~}|~~~~~~~}~~~~~~~~|~~~~~}}~~}yxsq~~~~~~~}~~~~~~}|||}}}~~}~|}~}~~~~}~}~~~~~~~~~}|~~~|~~}||{wu~~~~~~~~~}~~}|||}}|}}}}~}|}~~}~~~~~~~~~~~}~~~~}~|~v~~}}~}||~~}||}|||~~}}~~~}}~}~~~~~~}~~~}~|~{}~|~~~~~|}}|~~}}~{zz{~}~|}~|~~}~~~~~~~~~~~~~~~~}~|~|{||}}vrsrstrstuvsqsvwttutmkr~}{{||~{|{}{~|}|}|}|}}}~~~~~~~~~~}~~}|~~~}~~~wx}`tuuuuttolpqtnonmnmmvrsrou}ryz}~~{}}~}~|}~~}~~~~}~}}~~~~~~~~~~~}~~}}~zsab~wzcvsonptttnnrupmozzqhgrhw}zi~}]{{|{|}{w~~~~~||}|~~~~~}~~~~~~~~~~{~~~~~}~}~}~|{{|}vpc~{zetvsjh}}}xlkxtqll~|~{qkjths|zd~~~uz}}~~}||x}}||}~~}}}~}~~~~~~~~~~}~~~~~~~~~}~|~}~{|{z{yngze~pl|{jx~~m}}mt{n|{h~~}~~{|~}}~}~~~~~~}~~~~~~~}~~{}~|}|~}~}|~~~{~z{{~{}~}z~~~~~}~~~}~z~~{~|~~~~~~~}|~~~~~~}~~~~}~}~}}~~}|}}|z}y{~|{y~|}~}{}}~xx~|~t}{|y}~{{||}}|~~}~~~~~~~}~~}~~~~~~~~~~~~}}~|}~|}|}~}z|||usqpghighxhfihigqpqtnuqtx~~|~~wxvsrmsnrwr~~~~~~}}~}}~}~~~}}~~~~~~~|~|~~~}{~}~~|}z}z|{{stutgifjfxgigieloqnmjprpq|uM\v}~uuuqu~ywvtt~}}}~~~~~~~~~~}~~~~~~~~}}~}~~~~~~}}~|}v{|~|~usrrliijizgfigkqqnphnntsb~~SfvQk}uurov~rtwus~~~}x~~~}~~~}{~~~~}}}}}~~}~~}}~~}}~|}~~~~~v}||~stsrrsmkskyhfiilronngsqrpg{{xrJjvtNt~sqqo~~~wvtyw{{~}wx~~~~}z|}~}}~~}}}|}}}}|}}~}}}~}~~}~~}}~w|{yyprsrqrqtrsziggipoqonhyzxsocut:HuxtxWttttrqz|~{y|xy~|~~~~zx~}|}~~}~|}{||}~}~}|~~|}}~{z{{}|~~~~~~~~~~~}~~~~|{}{z{|psqtrrqrtvyihgopponour{}tkdL1@?JJYD|uwt|zxw~zxsvt~|~~~~~~|~}~}||{{~}}~}|{}~}||~|{|zz~|}{~|}|}}}~~}~}~~~~~~}||||u{wzvwuqsrrqqsvx~y~nlrspqmleez}utfuh}irhZ{ux{wtuf}{xyvw~}~~~~~~~~}~||~y}|zz|~~~~|}}{|~{}z|{}x}z}y~yy~z}|zy~y~|~~~}~~{|}|}~|||}|~wzxzvytusrtqquvtrurptnprmfky|x|ojmonrqcc|y{uytsva|~|ywpw~~~~~}}~}~}{|z~zzy{}{}|{{{}y~{}y|y|yx|wyw|xzxzx|xxx{y~~}~~~|~}}|~}~~~|}~{}x{}z{pstsrtsvusvmvxnpqonn`v|jlv\sfq{y}|xZOOV]``]wzxxw~~~~}~}}}zy~~wwx~}}}}|{{~|~|}yy|y{z}||z~|}{}}}{}|~~~~~~~~~~~~{z~}}}}~}tz}~~ptrsrtspij{hghrmqnnjeddmd\~bHFCGTZdb`\YY^xwt~~~~~yz{{~}~~~}{|}}zyx~x}yy{x{x|v~x~z|~{~z}~}~~~~|}y~|}}~x|||~rrqtrqqgiizhegloonkmdakik`TPQPIJQXYXTTTWWVYtr~tst~~xvuzy~}|~|~~~~~~~}}}|}}}~}}~}}~}~~~~~}~}}y}}vuqrrqshkjyghhipqmmkbqiij]uU`]WOINOQLPOPUSTVYYfx|vvykkiihir~~{yz}~}~~}~~}}~~~~~~}~~~xz|}|vttsuvmiihziiihpoqnmdmmsfk[c`cf=HMMGKLPOQOQSX[n_usx{~~~~}|wz~}~~~~|zy~~~~vuuuvwuv~~~~~|}~~~uu~|w{q|||zj|}nyy{xixhwyxvadmlkh[kfijUVTQOROQUVWU[\[X]f|tw~~|{||{|~}~~~~~~~~}}}~~~{~xxzpxwyxv{nyvyvuxmzvvtqz|ok~{iilnttrWRPPPSSWYTXXY^ao~~~~}~}~~~~~||~}~w~}~~}}y~|}}yljj|z}t]`]X[[XZ\]^a`c~~~~~~~~~}~~~}|~~}|}{|}|}}{{|~|{}|{|zz||sb```]^^_`Z`]ah}}}~~~|~~~~||~||||{z}}~~~~~~~}~~~~}~~~|}}|~}}wwxxxsid`babbcgccaddh~}~~}~~~~~~yzz{~~~~~{~~|~~~~}~~~~~}}|||{||zxzxxyxxhilfhfhieel~|~~|~~~~}{}||~~}~}|~}}}{|z{{z{{{z{||}}}|}{|{z{zwyzyzwyzxyyyyyzzw{xyxxyz{vwwvvutvttwwuqonmoow|~~~}~|}~~{z{~~~~}~}~}|~~|~}{~~|~~|}|~||~~|{|z|y{z{z{{{|xz{z{{|yxz{zyy{x{zyyxxwvvutrtyz{yzwsvuuy}|}}|~~~~}~~~~~~~~~~~~}|}~}~|{|~|}~~|}{|||~~{}}{{zzz{zzz{{zy{yz|yzz{zzzy{zyyyzyzzvywvtvsvuyxutttutu{}~}}}~~{~}~~~~~~~~~~}}}|~~}}}}}}|}~||~||||{z{z|{|{z{|zz{{{z{zyxzzz|yzyzzy{zz{z|zxyxxxwxzvzwwvvutxy}~~~~~~~}|}~~~~~~~~}~~}}~}}}}{}|||||}z}}||||||z{{{|{z{{zzzz{{zy{zyzzzxzzzz}z{{zzyyvtxxwwvwwvuvvx|~~~~}~z}~~~~~~~~~}~~}}~~~}{|}}{}|}||~}{{|}|{|z{z|zz{zyzy|xz|zzyyzz{wyyzzxz{{{}}ywxuxxwwxxwwxxzz|~~~~~~~|~~~~~~}~~~~~~~~~~}}}}{||{{}{z{|}{~||{|||{zyyz{zyzzz{zzzzy|z{x{z{xyz||||}{yyywwwxuzxxwzyy{|}~}~~~~}{}~~~~~~}~~}~}~}|~}}}~{}|{}}|}|}}||{{{{{z{zyy}{yxyy{{y{|y{zzy{zzxzz||{||}||yyvwxwwxvz{xy|}~}}~~~}~z~~}~~~~~}~|~}}|}~|}~~|}}|}~{}}{{{|z|z{{z{z|xz|{{|z{{{zz{zzyzzz{{}~{~}{|{yzzxyyyy{z{{}~}~~~}~~~~~}~~~}~~~~}~~}~~}~~}|~}~|||}}~}}}}}}{{|}|{|{{|{|z|z{z|{y|z{{{y{{z{z{|||||{}}{zyyzzzwyyz{}|}~~~~~{}~~~}~~}~~~~~}~}}}}}|||}}}}}~|}|}|z}||||{|{|z{|{{|{|yzz{|{|z|z{z{|{}}}~|}~|zyyz{{{z||y|~}|~}~~~~~}|~}~~}}}~~}~{}~}{}~~}|||}~|||||||{|{||{z{|{{|zzy{|}{z{}|}}|~}}~~}||x{{|y|}|{~~{~~}~~~~~~~}~}~~~~~~}|}}~|}~|~|}}}|~{}||{{{z{{z|z}|{||z|{}{z}z}}}z}}}~}}~}}|{}{|z|||||{}~}~~~~~}~~~}}~~}~}|}~}~~}}}}}}}}|{|{||}z}{}||}}{{|z}{|||}|}}~}~~~|}~~||{|~}}}~~~}}~}~~~~~~~~~~~~|}|}||}{}}|~}}~}}}||{{{||}}~|}||{|{}}|}|}{}~}||~}~~}~|~|{|}{}}}~}}~~~~~~~~~}~~~~}~~}~~~}~}||}{|~}}|~}~||}{{|}}}|{}||}|}|}|{}|}|}||}|~}~~~~}}}|}||}}|~}~~~~~~~~~~~~}}}}}~~}~|~~~}}}||}|||||{||||{}}||{|{||~|||{~~~~}}}~|~|}}}~}~~|~~~~~~~~~~~~~}~~~~}~~}}}~|}{}z}}}~||}|}}|{||}}}|~~~~~}|~~}~~~}}~~~~~~~~}~~~|~}}~~}}|}~}|}}||z}~}~}|}}|}}|~}~}~~~~~}}~~}~}~~}}~~~~}~~|~~~~~~~~|}}~~~~}}~~}{~~~|~~~~}}}~|||~}}~}|~~~~~~~}~~~~~~~~~~~}~}~~~~~~}~~}}~}}|}}}~}~~|{}}~~~~}}|}|}}~~~~~~~~}}~~~~}~~}~~~~~~~~}~~~~}~~|~|~}}}~~}~~}}~~|}}}~~~~~~~|~~
\ No newline at end of file
diff --git a/examples/libva_buffer_sharing/libva_buffer_sharing.cpp b/examples/libva_buffer_sharing/libva_buffer_sharing.cpp
new file mode 100644
index 0000000..04fe359
--- /dev/null
+++ b/examples/libva_buffer_sharing/libva_buffer_sharing.cpp
@@ -0,0 +1,443 @@
+/*
+ * Copyright (c) 2012 Intel Corporation. All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ *
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <stdint.h>
+#include <errno.h>
+
+#include <unistd.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <fcntl.h>
+#include <va/va.h>
+#include "va_display.h"
+
+#include <va/va_drmcommon.h>
+#include "utest_helper.hpp"
+
+#include <getopt.h>             /* getopt_long() */
+
+typedef cl_mem (OCLCREATEIMAGEFROMLIBVAINTEL)(cl_context, const cl_libva_image *, cl_int *);
+OCLCREATEIMAGEFROMLIBVAINTEL *oclCreateImageFromLibvaIntel = NULL;
+
+char *input_nv12;
+char *output_nv12;
+int frame_size;
+int picture_width, picture_height;
+unsigned char *newImageBuffer;
+VADisplay	va_dpy;
+cl_int cl_status;
+VAStatus va_status;
+
+static const char short_options[] = "i:r:o:h";
+
+static const struct option
+long_options[] = {
+  { "input", required_argument, NULL, 'i' },
+  { "help",   no_argument,       NULL, 'h' },
+  { "resolution", required_argument,       NULL, 'r' },
+  { "output",  required_argument, NULL, 'o' },
+  { 0, 0, 0, 0 }
+};
+
+#define OUTPUT_NV12_DEFAULT "./out.nv12"
+#define WIDTH_DEFAULT 256
+#define HEIGHT_DEFAULT 128
+
+#define CHECK_VASTATUS(va_status,func)                                  \
+  if (va_status != VA_STATUS_SUCCESS) {                                   \
+    fprintf(stderr, "status = %d, %s:%s (%d) failed,exit\n",va_status, __func__, func, __LINE__); \
+    exit(1);                                                            \
+  }
+
+#define CHECK_CLSTATUS(status,func)                                  \
+  if (status != CL_SUCCESS) {                                   \
+    fprintf(stderr, "status = %d, %s:%s (%d) failed,exit\n", status, __func__, func, __LINE__); \
+    exit(1);                                                            \
+  }
+
+static void usage(FILE *fp, int argc, char **argv)
+{
+  fprintf(fp,
+      "\n"
+      "This example aims to demostrate the usage of gpu buffer sharing between libva and Beignet.\n"
+      "The input and output file are nv12 format.\n"
+      "Please use the following command to see the result:\n"
+      "gst-launch-1.0 filesrc location=file_name ! videoparse format=nv12 width=xxx height=xxx ! imagefreeze ! videoconvert ! video/x-raw, format=BGRx ! ximagesink\n"
+      "(Please install gstreamer1.0-plugins-base, gstreamer1.0-plugins-bad, \n"
+      " gstreamer1.0-x by apt on Ubuntu, in order to use gst-launch-1.0)\n"
+      "For more details, please read docs/howto/libva-buffer-sharing-howto.mdwn.\n"
+      "\nUsage: %s [options]\n\n"
+      "Options:\n"
+      "-i | --input=<file_name>           Specify input nv12 file name like /home/xxx/in.nv12\n"
+      "-h | --help                        Print this message\n"
+      "-r | --resolution=<width,height>   Set input resolution\n"
+      "-o | --output=<file_name>          Specify input nv12 file name like /home/xxx/out.nv12\n"
+      "",
+      argv[0]);
+}
+
+static void analyse_args(int argc, char *argv[])
+{
+  input_nv12 = NULL;
+  picture_width = 0;
+  picture_height = 0;
+  output_nv12 = NULL;
+
+  int c, idx;
+  for (;;) {
+
+    c = getopt_long(argc, argv,
+        short_options, long_options, &idx);
+
+    if (-1 == c)
+      break;
+
+    switch (c) {
+      case 0: /* getopt_long() flag */
+        break;
+
+      case 'i':
+        input_nv12 = optarg;
+        break;
+
+      case '?':
+      case 'h':
+        usage(stdout, argc, argv);
+        exit(0);
+
+      case 'r':
+        sscanf(optarg, "%d,%d", &picture_width, &picture_height);
+        break;
+
+      case 'o':
+        output_nv12 = optarg;
+        break;
+
+      default:
+        usage(stderr, argc, argv);
+        exit(1);
+    }
+  }
+
+  if(!input_nv12){
+    input_nv12 = INPUT_NV12_DEFAULT;
+  }
+  if(!output_nv12){
+    output_nv12 = OUTPUT_NV12_DEFAULT;
+  }
+  if(picture_width == 0 && picture_height == 0){
+    picture_width = WIDTH_DEFAULT;
+    picture_height = HEIGHT_DEFAULT;
+  }
+  return;
+}
+
+
+static void initialize_va_ocl(){
+  int major_ver, minor_ver;
+
+  printf("\n***********************libva info: ***********************\n");
+  fflush(stdout);
+  va_dpy = va_open_display();
+  va_status = vaInitialize(va_dpy, &major_ver, &minor_ver);
+  CHECK_VASTATUS(va_status, "vaInitialize");
+
+  //ocl initialization: basic & create kernel & get extension
+  printf("\n***********************OpenCL info: ***********************\n");
+  if ((cl_status = cl_test_init("runtime_gray_effect.cl", "runtime_gray_effect", SOURCE)) != 0){
+    fprintf(stderr, "cl_test_init error\n");
+    exit(1);
+  }
+
+  oclCreateImageFromLibvaIntel = (OCLCREATEIMAGEFROMLIBVAINTEL *)clGetExtensionFunctionAddress("clCreateImageFromLibvaIntel");
+  if(!oclCreateImageFromLibvaIntel){
+    fprintf(stderr, "Failed to get extension clCreateImageFromLibvaIntel\n");
+    exit(1);
+  }
+}
+
+static void upload_nv12_to_surface(FILE *nv12_fp, VASurfaceID surface_id)
+{
+  VAImage surface_image;
+  void *surface_p = NULL;
+  unsigned char *y_src, *u_src, *v_src;
+  unsigned char *y_dst, *u_dst;
+  int y_size = picture_width * picture_height;
+  int u_size = (picture_width >> 1) * (picture_height >> 1);
+  int row, col;
+  size_t n_items;
+
+  n_items = fread(newImageBuffer, frame_size, 1, nv12_fp);
+
+  va_status = vaDeriveImage(va_dpy, surface_id, &surface_image);
+  CHECK_VASTATUS(va_status,"vaDeriveImage");
+
+  vaMapBuffer(va_dpy, surface_image.buf, &surface_p);
+  assert(VA_STATUS_SUCCESS == va_status);
+
+  y_src = newImageBuffer;
+  u_src = newImageBuffer + y_size; /* UV offset for NV12 */
+  v_src = newImageBuffer + y_size + u_size;
+
+  y_dst = (unsigned char *)surface_p + surface_image.offsets[0];
+  u_dst = (unsigned char *)surface_p + surface_image.offsets[1]; /* U offset for NV12 */
+
+  /* Y plane */
+  for (row = 0; row < surface_image.height; row++) {
+    memcpy(y_dst, y_src, surface_image.width);
+    y_dst += surface_image.pitches[0];
+    y_src += picture_width;
+  }
+
+  if (surface_image.format.fourcc == VA_FOURCC_NV12) { /* UV plane */
+    for (row = 0; row < surface_image.height / 2; row++) {
+      for (col = 0; col < surface_image.width / 2; col++) {
+        u_dst[col * 2] = u_src[col];
+        u_dst[col * 2 + 1] = v_src[col];
+      }
+      u_dst += surface_image.pitches[1];
+      u_src += (picture_width / 2);
+      v_src += (picture_width / 2);
+    }
+  } 
+
+  vaUnmapBuffer(va_dpy, surface_image.buf);
+  vaDestroyImage(va_dpy, surface_image.image_id);
+}
+
+static void create_y_image_object_from_libva(VAImage *surface_image,
+                                             VABufferInfo *buf_info,
+                                             cl_mem *yio_p)
+{
+  cl_libva_image info_image;
+  info_image.bo_name = buf_info->handle;
+  info_image.offset = surface_image->offsets[0];
+  info_image.width = surface_image->width;
+  info_image.height = surface_image->height;
+  info_image.fmt.image_channel_order = CL_R;
+  info_image.fmt.image_channel_data_type = CL_UNSIGNED_INT8;
+  info_image.row_pitch = surface_image->pitches[0];
+  *yio_p = oclCreateImageFromLibvaIntel(ctx, &info_image, &cl_status);
+  CHECK_CLSTATUS(cl_status, "oclCreateImageFromLibvaIntel");
+  printf("\nSuccessfully create ocl image object from y plane of VASurface...\n");
+}
+
+static void create_uv_image_object_from_libva(VAImage *surface_image,
+                                              VABufferInfo *buf_info,
+                                              cl_mem *yio_p)
+{
+  cl_libva_image info_image;
+  info_image.bo_name = buf_info->handle;
+  info_image.offset = surface_image->offsets[1];
+  info_image.width = surface_image->width / 2;
+  info_image.height = surface_image->height / 2;
+  info_image.fmt.image_channel_order = CL_R;
+  info_image.fmt.image_channel_data_type = CL_UNSIGNED_INT16;
+  info_image.row_pitch = surface_image->pitches[1];
+  *yio_p = oclCreateImageFromLibvaIntel(ctx, &info_image, &cl_status);
+  CHECK_CLSTATUS(cl_status, "oclCreateImageFromLibvaIntel");
+  printf("\nSuccessfully create ocl image object from uv plane of VASurface...\n");
+}
+
+static void store_surface_to_nv12(VASurfaceID surface_id, FILE *nv12_fp)
+{
+  VAImage surface_image;
+  void *surface_p = NULL;
+  unsigned char *y_src, *u_src;
+  unsigned char *y_dst, *u_dst, *v_dst;
+  int y_size = picture_width * picture_height;
+  int u_size = (picture_width >> 1) * (picture_height >> 1);
+  int row, col;
+
+  va_status = vaDeriveImage(va_dpy, surface_id, &surface_image);
+  CHECK_VASTATUS(va_status,"vaDeriveImage");
+
+  va_status = vaMapBuffer(va_dpy, surface_image.buf, &surface_p);
+  CHECK_VASTATUS(va_status,"vaMapBuffer");
+
+  y_src = (unsigned char *)surface_p + surface_image.offsets[0];
+  u_src = (unsigned char *)surface_p + surface_image.offsets[1]; /* U offset for NV12 */
+
+  y_dst = newImageBuffer;
+  u_dst = newImageBuffer + y_size; /* UV offset for NV12 */
+  v_dst = newImageBuffer + y_size + u_size;
+
+  /* Y plane */
+  for (row = 0; row < surface_image.height; row++) {
+    memcpy(y_dst, y_src, surface_image.width);
+    y_src += surface_image.pitches[0];
+    y_dst += picture_width;
+  }
+
+  if (surface_image.format.fourcc == VA_FOURCC_NV12) { /* UV plane */
+    for (row = 0; row < surface_image.height / 2; row++) {
+      for (col = 0; col < surface_image.width / 2; col++) {
+        u_dst[col] = u_src[col * 2];
+        v_dst[col] = u_src[col * 2 + 1];
+      }
+      u_src += surface_image.pitches[1];
+      u_dst += (picture_width / 2);
+      v_dst += (picture_width / 2);
+    }
+  } 
+
+  fwrite(newImageBuffer, frame_size, 1, nv12_fp);
+
+  vaUnmapBuffer(va_dpy, surface_image.buf);
+  vaDestroyImage(va_dpy, surface_image.image_id);
+}
+
+static void load_process_store_nv12()
+{
+  frame_size = picture_width * picture_height +  ((picture_width * picture_height) >> 1) ;
+  newImageBuffer = (unsigned char *)malloc(frame_size);
+
+  VASurfaceID src_surface_id;
+  VASurfaceAttrib forcc;
+  forcc.type =VASurfaceAttribPixelFormat;
+  forcc.flags=VA_SURFACE_ATTRIB_SETTABLE;
+  forcc.value.type=VAGenericValueTypeInteger;
+  forcc.value.value.i = VA_FOURCC_NV12;
+  va_status = vaCreateSurfaces(va_dpy, VA_RT_FORMAT_YUV420,
+                               picture_width, picture_height,
+                               &src_surface_id, 1, &forcc, 1);
+  CHECK_VASTATUS(va_status, "vaCreateSurfaces");
+
+  //load
+  FILE *in_nv12_fp;
+  in_nv12_fp = fopen(input_nv12, "rb");
+  if (in_nv12_fp == NULL){
+    fprintf(stderr, "Can't open input nv12 file\n");
+    exit(1);
+  }
+  fseek(in_nv12_fp, 0l, SEEK_END);
+  off_t file_size = ftell(in_nv12_fp);
+
+  if ((file_size < frame_size) || (file_size % frame_size) ) {
+    fclose(in_nv12_fp);
+    fprintf(stderr, "The nv12 file's size is not correct\n");
+    exit(1);
+  }
+  fseek(in_nv12_fp, 0l, SEEK_SET);
+  upload_nv12_to_surface(in_nv12_fp, src_surface_id);
+  fclose(in_nv12_fp);
+  printf("\nSuccessfully load source nv12 file(\"%s\") to VASurface...\n", input_nv12);
+
+
+  //create two corresponding ocl image objects from source VASurface
+  VAImage src_surface_image;
+  va_status = vaDeriveImage(va_dpy, src_surface_id, &src_surface_image);
+  CHECK_VASTATUS(va_status,"vaDeriveImage");
+  VABufferInfo buf_info;
+  buf_info.mem_type = VA_SURFACE_ATTRIB_MEM_TYPE_KERNEL_DRM;
+  va_status = vaAcquireBufferHandle(va_dpy, src_surface_image.buf, &buf_info);
+  CHECK_VASTATUS(va_status,"vaAcquireBufferHandle");
+  cl_mem src_y, src_uv;	
+  create_y_image_object_from_libva(&src_surface_image, &buf_info, &src_y);
+  OCL_CALL (clSetKernelArg, kernel, 0, sizeof(cl_mem), &src_y);
+
+  create_uv_image_object_from_libva(&src_surface_image, &buf_info, &src_uv);
+  OCL_CALL (clSetKernelArg, kernel, 1, sizeof(cl_mem), &src_uv);
+
+
+  //create one target VASurface & create corresponding target ocl image object from it
+  VASurfaceID dst_surface_id;
+  va_status = vaCreateSurfaces(va_dpy,VA_RT_FORMAT_YUV420,
+                               picture_width,picture_height,
+                               &dst_surface_id, 1, &forcc, 1);
+  CHECK_VASTATUS(va_status, "vaCreateSurfaces");
+
+  VAImage dst_surface_image;
+  va_status = vaDeriveImage(va_dpy, dst_surface_id, &dst_surface_image);
+  CHECK_VASTATUS(va_status,"vaDeriveImage");
+  va_status = vaAcquireBufferHandle(va_dpy, dst_surface_image.buf, &buf_info);
+  CHECK_VASTATUS(va_status,"vaAcquireBufferHandle");
+  cl_mem dst_y, dst_uv;	
+  create_y_image_object_from_libva(&dst_surface_image, &buf_info, &dst_y);
+  OCL_CALL (clSetKernelArg, kernel, 2, sizeof(cl_mem), &dst_y);
+  create_uv_image_object_from_libva(&dst_surface_image, &buf_info, &dst_uv);
+  OCL_CALL (clSetKernelArg, kernel, 3, sizeof(cl_mem), &dst_uv);
+
+
+  size_t global_size[2];
+  global_size[0] = picture_width;
+  global_size[1] = picture_height;
+  OCL_CALL (clEnqueueNDRangeKernel, queue, kernel, 2, NULL,
+            global_size, NULL, 0, NULL, NULL);
+  OCL_CALL (clFinish, queue);
+  printf("\nSuccessfully use ocl to do processing...\n");
+
+  va_status = vaReleaseBufferHandle(va_dpy, src_surface_image.buf);
+  CHECK_VASTATUS(va_status,"vaReleaseBufferHandle");
+  va_status = vaReleaseBufferHandle(va_dpy, dst_surface_image.buf);
+  CHECK_VASTATUS(va_status,"vaReleaseBufferHandle");
+
+  OCL_CALL (clReleaseMemObject, src_y);
+  OCL_CALL (clReleaseMemObject, src_uv);
+  OCL_CALL (clReleaseMemObject, dst_y);
+  OCL_CALL (clReleaseMemObject, dst_uv);
+  vaDestroyImage(va_dpy, src_surface_image.image_id);
+  vaDestroyImage(va_dpy, dst_surface_image.image_id);
+  cl_kernel_destroy();
+  cl_ocl_destroy();
+
+  //store
+  FILE *out_nv12_fp;
+  out_nv12_fp = fopen(output_nv12,"wb");
+  if ( out_nv12_fp == NULL){
+    fprintf(stderr, "Can't open output nv12 file\n");
+    exit(1);
+  }
+  store_surface_to_nv12(dst_surface_id, out_nv12_fp);
+  fclose(out_nv12_fp);
+  printf("\nSuccessfully store VASurface to dst nv12 file(\"%s\")...\n", output_nv12);
+
+  //release resources
+  vaDestroySurfaces(va_dpy,&src_surface_id,1);
+  vaDestroySurfaces(va_dpy,&dst_surface_id,1);
+
+  vaTerminate(va_dpy);
+  va_close_display(va_dpy);
+}
+
+
+int main(int argc, char *argv[])
+{
+  analyse_args(argc, argv);
+
+  initialize_va_ocl();
+
+  load_process_store_nv12();
+
+  printf("\nExample run successfully!\n");
+  printf("\nNote: The input and output file are nv12 format.\n");
+  printf("Please use the following command to see the result:\n");
+  printf("gst-launch-1.0 filesrc location=%s ! videoparse format=nv12 width=%d height=%d ! imagefreeze ! videoconvert ! video/x-raw, format=BGRx ! ximagesink\n", output_nv12, picture_width, picture_height);
+  printf("(Please install gstreamer1.0-plugins-base, gstreamer1.0-plugins-bad,\ngstreamer1.0-x by apt on Ubuntu, in order to use gst-launch-1.0)\n");
+
+  return 0;
+}
diff --git a/examples/libva_buffer_sharing/sysdeps.h b/examples/libva_buffer_sharing/sysdeps.h
new file mode 100644
index 0000000..4de764d
--- /dev/null
+++ b/examples/libva_buffer_sharing/sysdeps.h
@@ -0,0 +1,79 @@
+/*
+ * Copyright (c) 2007-2009 Intel Corporation. All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ * 
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL INTEL AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#ifndef SYSDEPS_H
+#define SYSDEPS_H
+
+#ifdef HAVE_CONFIG_H
+# include "config.h"
+#endif
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <stdbool.h>
+#include <string.h>
+#include <stdint.h>
+#include <assert.h>
+
+#ifdef ANDROID
+# define Bool  int
+# define True  1
+# define False 0
+
+/* Macros generated from configure */
+# define LIBVA_VERSION_S "1.1.0"
+
+/* Android logging utilities */
+# include <utils/Log.h>
+
+# ifdef ANDROID_ALOG
+#  define va_log_error(buffer)  do { ALOGE("%s", buffer); } while (0)
+#  define va_log_info(buffer)   do { ALOGI("%s", buffer); } while (0)
+# elif ANDROID_LOG
+#  define va_log_error(buffer)  do { LOGE("%s", buffer); } while (0)
+#  define va_log_info(buffer)   do { LOGI("%s", buffer); } while (0)
+# endif
+#endif
+
+#ifndef va_log_error
+#define va_log_error(buffer) do {                       \
+        fprintf(stderr, "libva error: %s", buffer);     \
+    } while (0)
+#endif
+
+#ifndef va_log_info
+#define va_log_info(buffer) do {                        \
+        fprintf(stderr, "libva info: %s", buffer);      \
+    } while (0)
+#endif
+
+#if defined __GNUC__ && defined HAVE_GNUC_VISIBILITY_ATTRIBUTE
+# define DLL_HIDDEN __attribute__((visibility("hidden")))
+# define DLL_EXPORT __attribute__((visibility("default")))
+#else
+# define DLL_HIDDEN
+# define DLL_EXPORT
+#endif
+
+#endif /* SYSDEPS_H */
diff --git a/examples/libva_buffer_sharing/va_display.c b/examples/libva_buffer_sharing/va_display.c
new file mode 100644
index 0000000..dd58dd2
--- /dev/null
+++ b/examples/libva_buffer_sharing/va_display.c
@@ -0,0 +1,166 @@
+/*
+ * Copyright (c) 2012 Intel Corporation. All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ * 
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#include "sysdeps.h"
+#include <stdio.h>
+#include <stdlib.h>
+#include <stddef.h>
+#include <string.h>
+#include <va/va.h>
+#include "va_display.h"
+
+extern const VADisplayHooks va_display_hooks_android;
+extern const VADisplayHooks va_display_hooks_wayland;
+extern const VADisplayHooks va_display_hooks_x11;
+extern const VADisplayHooks va_display_hooks_drm;
+
+static const VADisplayHooks *g_display_hooks;
+static const VADisplayHooks *g_display_hooks_available[] = {
+#ifdef ANDROID
+    &va_display_hooks_android,
+#else
+#ifdef HAVE_VA_WAYLAND
+    &va_display_hooks_wayland,
+#endif
+#ifdef HAVE_VA_X11
+    &va_display_hooks_x11,
+#endif
+#ifdef HAVE_VA_DRM
+    &va_display_hooks_drm,
+#endif
+#endif
+    NULL
+};
+
+static const char *g_display_name;
+
+static const char *
+get_display_name(int argc, char *argv[])
+{
+    const char *display_name = NULL;
+    int i;
+
+    for (i = 1; i < argc; i++) {
+        if (strcmp(argv[i], "--display") != 0)
+            continue;
+        argv[i] = NULL;
+
+        if (++i < argc) {
+            display_name = argv[i];
+            argv[i] = NULL;
+        }
+    }
+    return display_name;
+}
+
+static void
+print_display_names(void)
+{
+    const VADisplayHooks **h;
+
+    printf("Available displays:\n");
+    for (h = g_display_hooks_available; *h != NULL; h++)
+        printf("  %s\n", (*h)->name);
+}
+
+static void
+sanitize_args(int *argc, char *argv[])
+{
+    char **out_args = argv;
+    int i, n = *argc;
+
+    for (i = 0; i < n; i++) {
+        if (argv[i])
+            *out_args++ = argv[i];
+    }
+    *out_args = NULL;
+    *argc = out_args - argv;
+}
+
+void
+va_init_display_args(int *argc, char *argv[])
+{
+    const char *display_name;
+
+    display_name = get_display_name(*argc, argv);
+    if (display_name && strcmp(display_name, "help") == 0) {
+        print_display_names();
+        exit(0);
+    }
+    g_display_name = display_name;
+
+    sanitize_args(argc, argv);
+}
+
+VADisplay
+va_open_display(void)
+{
+    VADisplay va_dpy = NULL;
+    unsigned int i;
+
+    for (i = 0; !va_dpy && g_display_hooks_available[i]; i++) {
+        g_display_hooks = g_display_hooks_available[i];
+        if (g_display_name &&
+            strcmp(g_display_name, g_display_hooks->name) != 0)
+            continue;
+        if (!g_display_hooks->open_display)
+            continue;
+        va_dpy = g_display_hooks->open_display();
+    }
+
+    if (!va_dpy)  {
+        fprintf(stderr, "error: failed to initialize display");
+        if (g_display_name)
+            fprintf(stderr, " '%s'", g_display_name);
+        fprintf(stderr, "\n");
+        abort();
+    }
+    return va_dpy;
+}
+
+void
+va_close_display(VADisplay va_dpy)
+{
+    if (!va_dpy)
+        return;
+
+    if (g_display_hooks && g_display_hooks->close_display)
+        g_display_hooks->close_display(va_dpy);
+}
+
+VAStatus
+va_put_surface(
+    VADisplay          va_dpy,
+    VASurfaceID        surface,
+    const VARectangle *src_rect,
+    const VARectangle *dst_rect
+)
+{
+    if (!va_dpy)
+        return VA_STATUS_ERROR_INVALID_DISPLAY;
+
+    if (g_display_hooks && g_display_hooks->put_surface)
+        return g_display_hooks->put_surface(va_dpy, surface, src_rect, dst_rect);
+    return VA_STATUS_ERROR_UNIMPLEMENTED;
+}
diff --git a/examples/libva_buffer_sharing/va_display.h b/examples/libva_buffer_sharing/va_display.h
new file mode 100644
index 0000000..4ed33e0
--- /dev/null
+++ b/examples/libva_buffer_sharing/va_display.h
@@ -0,0 +1,64 @@
+/*
+ * Copyright (c) 2012 Intel Corporation. All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ * 
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#ifndef VA_DISPLAY_H
+#define VA_DISPLAY_H
+
+#include <va/va.h>
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+typedef struct {
+    const char *name;
+    VADisplay (*open_display)   (void);
+    void      (*close_display)  (VADisplay va_dpy);
+    VAStatus  (*put_surface)    (VADisplay va_dpy, VASurfaceID surface,
+                                 const VARectangle *src_rect,
+                                 const VARectangle *dst_rect);
+} VADisplayHooks;
+
+void
+va_init_display_args(int *argc, char *argv[]);
+
+VADisplay
+va_open_display(void);
+
+void
+va_close_display(VADisplay va_dpy);
+
+VAStatus
+va_put_surface(
+    VADisplay          va_dpy,
+    VASurfaceID        surface,
+    const VARectangle *src_rect,
+    const VARectangle *dst_rect
+);
+
+#ifdef __cplusplus
+}
+#endif
+
+#endif /* VA_DISPLAY_H */
diff --git a/examples/libva_buffer_sharing/va_display_x11.c b/examples/libva_buffer_sharing/va_display_x11.c
new file mode 100755
index 0000000..336bf86
--- /dev/null
+++ b/examples/libva_buffer_sharing/va_display_x11.c
@@ -0,0 +1,139 @@
+/*
+ * Copyright (c) 2012 Intel Corporation. All Rights Reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a
+ * copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sub license, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ * 
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ * 
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
+ * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT.
+ * IN NO EVENT SHALL PRECISION INSIGHT AND/OR ITS SUPPLIERS BE LIABLE FOR
+ * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#include <stdio.h>
+#include <stdbool.h>
+#include <va/va_x11.h>
+#include "va_display.h"
+
+static Display *x11_display;
+static Window   x11_window;
+
+static VADisplay
+va_open_display_x11(void)
+{
+    x11_display = XOpenDisplay(NULL);
+    if (!x11_display) {
+        fprintf(stderr, "error: can't connect to X server!\n");
+        return NULL;
+    }
+    return vaGetDisplay(x11_display);
+}
+
+static void
+va_close_display_x11(VADisplay va_dpy)
+{
+    if (!x11_display)
+        return;
+
+    if (x11_window) {
+        XUnmapWindow(x11_display, x11_window);
+        XDestroyWindow(x11_display, x11_window);
+        x11_window = None;
+    }
+    XCloseDisplay(x11_display);
+    x11_display = NULL;
+}
+
+static int
+ensure_window(unsigned int width, unsigned int height)
+{
+    Window win, rootwin;
+    unsigned int black_pixel, white_pixel;
+    int screen;
+
+    if (!x11_display)
+        return 0;
+
+    if (x11_window) {
+        XResizeWindow(x11_display, x11_window, width, height);
+        return 1;
+    }
+
+    screen      = DefaultScreen(x11_display);
+    rootwin     = RootWindow(x11_display, screen);
+    black_pixel = BlackPixel(x11_display, screen);
+    white_pixel = WhitePixel(x11_display, screen);
+
+    win = XCreateSimpleWindow(
+        x11_display,
+        rootwin,
+        0, 0, width, height,
+        1, black_pixel, white_pixel
+    );
+    if (!win)
+        return 0;
+    x11_window = win;
+
+    XMapWindow(x11_display, x11_window);
+    XSync(x11_display, False);
+    return 1;
+}
+
+static inline bool
+validate_rect(const VARectangle *rect)
+{
+    return (rect            &&
+            rect->x >= 0    &&
+            rect->y >= 0    &&
+            rect->width > 0 &&
+            rect->height > 0);
+}
+
+static VAStatus
+va_put_surface_x11(
+    VADisplay          va_dpy,
+    VASurfaceID        surface,
+    const VARectangle *src_rect,
+    const VARectangle *dst_rect
+)
+{
+    unsigned int win_width, win_height;
+
+    if (!va_dpy)
+        return VA_STATUS_ERROR_INVALID_DISPLAY;
+    if (surface == VA_INVALID_SURFACE)
+        return VA_STATUS_ERROR_INVALID_SURFACE;
+    if (!validate_rect(src_rect) || !validate_rect(dst_rect))
+        return VA_STATUS_ERROR_INVALID_PARAMETER;
+
+    win_width  = dst_rect->x + dst_rect->width;
+    win_height = dst_rect->y + dst_rect->height;
+    if (!ensure_window(win_width, win_height))
+        return VA_STATUS_ERROR_ALLOCATION_FAILED;
+    return vaPutSurface(va_dpy, surface, x11_window,
+                        src_rect->x, src_rect->y,
+                        src_rect->width, src_rect->height,
+                        dst_rect->x, dst_rect->y,
+                        dst_rect->width, dst_rect->height,
+                        NULL, 0,
+                        VA_FRAME_PICTURE);
+}
+
+const VADisplayHooks va_display_hooks_x11 = {
+    "x11",
+    va_open_display_x11,
+    va_close_display_x11,
+    va_put_surface_x11,
+};
diff --git a/kernels/runtime_gray_effect.cl b/kernels/runtime_gray_effect.cl
new file mode 100644
index 0000000..b89eeae
--- /dev/null
+++ b/kernels/runtime_gray_effect.cl
@@ -0,0 +1,28 @@
+__kernel void
+runtime_gray_effect(__read_only image2d_t src_y,
+                    __read_only image2d_t src_uv,
+                    __write_only image2d_t dst_y,
+                    __write_only image2d_t dst_uv)
+{
+  const sampler_t sampler = CLK_NORMALIZED_COORDS_FALSE | CLK_FILTER_NEAREST;
+  int2 coord_r, coord_w;
+  uint4 color = (uint4)(0, 0, 0, 0);
+
+  coord_r.x = (int)get_global_id(0);
+  coord_r.y = (int)get_global_id(1);
+
+  coord_w = coord_r;
+
+  color = read_imageui(src_y, sampler, coord_r);
+
+  write_imageui(dst_y, coord_w, color);
+
+  coord_r /= 2;
+  coord_w /= 2;
+  color = read_imageui(src_uv, sampler, coord_r);
+
+  color.x = 0x8080;
+
+  write_imageui(dst_uv, coord_w, color);
+}
+
-- 
1.9.1

